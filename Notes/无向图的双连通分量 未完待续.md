[TOC]

> 开局一个 Markdown，内容全靠编。——Orange

# 无向图的双连通分量

## 概念

无向图的双连通分量分成两类。第一类叫做边双连通分量，第二类叫做点双连通分量。在了解它们之前，得先明白什么是割点和割边。

割点：无向连通图中，若删去一个点以及与它相连的边后图不再连通，则称这个点为该图的*割点*。又称*割顶*。

割边：无向连通图中，若删去一条边后该图不再连通，则称这条边为该图的*割边*。又称*桥*。

点双连通分量：无向连通图中，如果任意两点至少存在两条“点不重复”的路径，则称这个图是*点双连通的*。这等价于所有点都不是割顶。称点双连通的极大子图为*点双连通分量*，简称*点双*。

边双连通分量：无向连通图中，如果任意两点至少存在两条“边不重复”的路径，我们称这个图是*边双连通的*。这等价于所有边都不是桥。边双连通的极大子图称为*边双连通分量*，简称*边双*。

点双连通分量等价于要求任意两条边都在同一个简单环中；边双连通分量等价于要求每条边都至少在一个简单环中。显然，边双连通分量的要求比点双连通分量低一点。

**边双连通分量没有公共结点，而点双连通分量可能有公共结点。**

------

在开始下面的内容之前，请确保你已经学会了 Tarjan（强连通分量）算法。这里我们要用到 Tarjan 算法的两个概念：

1. $dfn$：又称*时间戳*。当第一次访问到某个结点时，我们令这个结点的 $dfn$ 等于一个计数器的值，并让这个计数器加一。
2. $low$：从某个结点出发能够到达的结点中的 $dfn$ 的最小值。

除此之外，我们还要用到三个概念：

1. DFS 树：假设这张无向图是连通图，我们从某个结点开始 DFS，要求不经过重复的点。这样 DFS 的过程必然呈树形结构，我们称这棵树为 *DFS 树*。
2. 树边：显然 DFS 树中的每一条边在原图中都存在。我们称这些边为*树边*。
3. 返祖边：对于原图（无向图）不是树边的边，它们一定指向 DFS 树上的祖先。称这些边为*返祖边*。

显然的是，**无向图的** DFS 树只由树边和返祖边两种边组成。

## 边双连通分量

##### 1. 找割边

观察下面的 DFS 树：

<img src="pic/无向图的双连通分量 1.png" style="zoom:75%">

这张图的 $dfn_x = low_x$，这意味着什么呢？如果 $x$ 想要到达它的父结点，它只能走父结点指向它的那条边。换句话说，如果拆掉这条边，$x$ 就和它的父结点不连通了。所以这条边是一条割边。

反之，如果 $dfn_x > low_x$，那么 $x$ 的儿子的返祖边一定能走回 $x$ 的祖先，而 $x$ 的祖先一定能走到 $x$ 的父亲，也就是说拆掉 $x$ 与它父结点的连边后 $x$ 与它的父结点仍然连通，因此这样的话 $x$ 与它父亲的连边不是割边。

另外，上面的论述也说明了返祖边一定不会是割边。

------

具体实现时，我们考虑一条树边 $u \to v$，判断它是不是割边。如果有 $dfn_u > low_v$，就说明从 $u$ 出发走到 $v$ 后回不到 $u$，那么 $(u, v)$ 就是条桥边。由于每条树边我们只会考虑一次，因此不会重复统计割边。

##### 2. 找边双连通分量

有两个方法。

###### ①方法 1

可以直接用 Tarjan（SCC）算法来求。与有向图的唯一区别是“不回头走刚刚走过的边”。这样，求出的每一个“强连通分量”就是一个边双连通分量。

###### ②方法 2

可以先找出所有的桥。**由于边双连通分量之间是没有公共点的**，所以只要保证不走桥就好了。这样每 DFS 出一个连通块就是一个边双连通分量。

## 点双连通分量

##### 1. 找割点

<img src="pic/无向图的双连通分量 1.png" style="zoom:75%">

这张图的 $dfn_x = low_x$，这意味着什么呢？显然 $x$ 是一个割点，删去 $x$ 后 $x$ 的后代与 $x$ 的祖先不再连通。换句话说，对于树边 $u \to v$，如果 $dfn_u \ge low_v$，那么 $u$ 是一个割点。

注意到，这么判断的话根结点无论如何都会被判成割点，因此要特判根结点——若根结点的度数为 $1$，那么根结点不是割点，否则根节点就是割点。

另外，我们是通过考虑树边来判断一个点是否是割点的，换句话说，一个点可能会被考虑多次。因此求割点时一般需要开一个数组保存每个点是否是割点，而不是找到后直接输出，否则可能会算重。

##### 2. 找点双连通分量

有缘再学吧……