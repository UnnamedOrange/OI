[TOC]

# 仙人掌（1）（未完待续）

[参考资料](http://blog.csdn.net/zhangche0526/article/details/71879985#bzoj1023cactus仙人掌图shoi2008)

##### 1. 概念

​	![仙人掌 1](pic\仙人掌 1.png)

​	（上图为每逢仙人掌必出的图）

###### ①仙人掌

​	若有一个**无向连通**图 $G$，$G$ 的**任意边属于至多一个简单环[^1]**，则称 $G$ 为仙人掌。

​	虽然仙人掌的一条边最多属于一个环，但是**仙人掌的一个点可能属于多个环。**

###### ②图论中与仙人掌有关的概念

​	桥边：在无向连通图 $G$ 中，若删去某条边 $e$ 后，图不连通，则称 $e$ 为 $G$ 的桥。在仙人掌中，就是非环边[^2]。

##### 2. 圆方树

​	![仙人掌 2](pic\仙人掌 2.png)

​	（上图为一棵圆方树）

​	如果我们能把仙人掌放在树上取搞它那该多好！事实上，圆方树就是一个解决**静态**仙人掌问题的重要方法。

###### ①定义

​	仙人掌 $G = (V, E)$ 的圆方树 $T = (V_T, E_T)$ 为满足以下条件的无向图：

​	①$V_T = R_T \cup S_T, R_T = V, R_T \cap S_T = \emptyset$，我们称 $R_T$ 集合为圆点，$S_T$ 集合为方点。

​	②$\forall e \in E$，若 $e$ 不在任何简单环中，则 $e \in E_T$。

​	说人话：**原仙人掌上所有点都是圆点；**为仙人掌的每一个环新建一个方点，所有在环上的（圆）点都要与方点相连，同时删去所有环边。

###### ②性质

​	（1）圆方树的形态与根的选取无关。换句话说，**没有编号的仙人掌和圆方树是一一对应的。**

​	（2）子圆方树对应子仙人掌[^3]。

​	（3）方点和方点不会直接相连。

###### ③构建

​	使用 Tarjan 求点双连通分量的算法。对于每一个点双连通分量，都建立一个方点，依次向栈中的圆点连边。从栈中取出一个点双连通分量时，栈中的顺序就是环上的顺序。如果找的边为桥边，我们直接在新图中原样加入它就是了。

​	所以让我们先复（预）习下点双连通分量。

[^1]: 感性地理解，就是环。
[^2]: 感性地理解，就是环上的边。

[^3]: 子仙人掌：以 r 为根的仙人掌上的点 p 所在的的子仙人掌是从仙人掌中去掉 p 到 r 的简单路径上的所有边后，p 所在的连通块。