[TOC]

# 数论函数

#### 数论函数

#####1. 定义

​	把==定义域为正整数==，陪域[^ 1 ]为复数的函数称为数论函数。~~所以说我们研究的范围可广了……~~

[^ 1 ]: 包含值域的任意集合，称为陪域。

##### 2. 记号

######艾弗森约定

​	将真或假的命题 $P(k)$ 放在方括号中。当命题 $P(k)$ 为真时，命题的结果为 1；为假时，结果为 0。这种表示方法叫作==艾弗森约定==。
$$
[命题 \, k] = 
\left\{\begin{matrix}
0, \, k \, 为假
\\
1, \, k \, 为真
\end{matrix}\right.
$$

####积性函数

##### 1. 定义

​	积性函数：对于**任意互质的整数** $a$ 和 $b$ 有 $f(ab) = f(a) f(b)$ 的数论函数，称为积性函数。

​	完全积性函数：对于**任意整数** $a$ 和 $b$ 有 $f(ab) = f(a) f(b)$ 的数论函数，称为完全积性函数。

##### 2. 常见积性函数

###### ①单位函数

$$
\epsilon(n)
\\
\epsilon(n) = [n = 1]
$$

###### ②常函数

$$
1(n)
\\
1(n) = 1
$$

​	常函数是完全积性函数。

​	常函数也写作 $1$。

###### ③恒等函数

$$
id(n)
\\
id(n) = n
$$

​	恒等函数是完全积性函数。

###### ④欧拉函数

$$
\varphi(n)
\\
\varphi(n) = \sum _{i = 1} ^{n} [\gcd(i, n) = 1]
$$

###### ⑤除数函数

$$
\sigma_k(n)
\\
\sigma_k(n) = \sum _{d \mid n} d^k
$$

​	==$\sigma_0(n)$ 表示 $n$ 的正因子数目，也记为 $d(n)$。==

​	==$\sigma_1(n)$ 表示 $n$ 的正因子之和，也记为 $\sigma(n)$。==

###### ⑥莫比乌斯（Möbius）函数

$$
\mu(n)
\\
\mu(n) = 
\left\{\begin{matrix}
0 \;\;\;\;\;\;\;\; \exists d > 1, \, d^2 \mid n
\\
1 \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\, n = 1
\\
(-1)^k \;\;\;\;\;\;\;\; n = \prod _{i = 1} ^ {k} p_i
\end{matrix}\right.
$$

​	==当 $n = 1$ 时，$\mu(n) = 1$；当 $n$ 存在一个质因子的指数大于等于 2 时，$\mu(n) = 0$；否则，当 $n$ 有奇数个质因子时，$\mu(n) = -1$；当 $n$ 有偶数个质因子时，$\mu(n) = 1$。==

​	$n = 1$ 的情况可以归类到 $n$ 有偶数个因子的情况。

##### 3. 欧拉函数

###### ①性质

$$
\varphi(ab) = \varphi(a) \phi(b) \frac {\gcd(a, b)} {\varphi(\gcd(a, b))} = \varphi(lcm(a, b)) \varphi(\gcd(a, b))
$$

###### ②欧拉函数线性筛

​	用最小的因子去筛。

​	当 $i$ 为质数时，$\varphi(i)$ 为 $i - 1$；当 $i$ 与 $k$ 互质时，$\varphi(ki) = \varphi(i) × \varphi(k) = \varphi(i) × (k - 1)$；当 $i$ 与 $k$ 不互质且 $k$ 是 $i$ 的最小质因子时，$\varphi(ki) = \varphi(k) \varphi(i) \frac {gcd(k, i)} {\varphi(gcd(k, i))} = \varphi(k) \varphi(i) \frac {k} {\varphi(k)} = \varphi(i) × k$。

##### 4. 狄利克雷卷积

###### ①定义

​	设数论函数 $f$，$g$，则它们的狄利克雷卷积可以表示为 $f * g$。

​	设 $h = f * g$，有：
$$
h(n) = (f * g)(n) = \sum _{d \mid n} f(n) g(\frac {n} {d})
$$
​	称 $h$ 为 $f$ 和 $g$ 的狄利克雷卷积。

###### ②运算律

​	（1）交换律：$f * g = g * f$

​	（2）结合律：$(f * g) * h = f * (g * h)$

​	（3）单位元

​		==若有数论函数 $h$ 对于所有的数论函数 $f$，均有 $f * h = h * f = f$，称 $h$ 为单位数论函数，或称之为卷积单位元。==

​		==**通过验证不难得到，狄利克雷卷积的单位元为 $\epsilon$。**==

###### ③积性

​	若 $f$ 和 $g$ 均为积性函数，则 $f * g$ 为积性函数；反之，若 $g$ 和 $f * g$ 均为积性函数，则 $f$ 为积性函数。

###### ④举例

$$
d(n) = \sum _{d \mid n} 1
\\
d = 1 * 1
$$


$$
\sigma(n) = \sum _{d \mid n} d
\\
\sigma = id * 1
$$

$$
\sum _{d \mid n} \mu(d) = \epsilon(n)
\\
\mu * 1 = \epsilon
$$
​	上式为莫比乌斯等式，将在下文讲解。


$$
\varphi(n) = \sum_{d \mid n} \mu(d) \frac {n} {d}
\\
\varphi = \mu * id
$$

#（玄学模式）


$$
\varphi * 1 = id
$$

#（玄学模式）

​	可以用数学归纳法证明一下：

>   设 $h = \varphi * 1$。易知 $h(1) = 1$。
>
>   当 $n > 1$ 时，假设 $h(n) = n$。
>
>   设 $n = \prod _{1 \le i \le k} p_i^{r_i}$。
>
>   （1）若 $n' = n * p_{k + 1}$
>   $$
>   h(n') = h(n * p_{k + 1}) = h(n) * h(p_{k + 1})
>   $$
>   由假设，上式等于
>   $$
>   n * p_{k + 1} = n'
>   $$
>   （2）若 $n' = n * p_{j, j \in [1, k]}$
>   $$
>   h(n') = h(\prod _{1 \le i \le k, i \ne j} p_{i}^{r_i} * p_j^{r_j + 1})
>   $$
>   由狄利克雷卷积的积性和假设，上式等于
>   $$
>   h(\prod _{1 \le i \le k, i \ne j} p_{i}^{r_i}) *h(p_j^{r_j + 1})
>   \\
>   =\prod _{1 \le i \le k, i \ne j} p_{i}^{r_i} * p_j^{r_j + 1} = n'
>   $$
>   得证！



#### 莫比乌斯反演

#####1. 莫比乌斯等式

$$
\sum _{d \mid n} \mu(d) = \epsilon(n)
\\
\mu * 1 = \epsilon
$$

​	$\epsilon$ 为单位函数。

###### ①证明

​	当 $n = 1$ 时，答案显然成立。

​	当 $n > 1$ 时，$n = \prod_i^k p_i^{a_i}$。

​	则有
$$
\forall_{d \mid n, \mu(d) \ne 0} d = \prod_{i \in I} p_i, \, I \subseteq \{ 1, 2, ... , k \}
$$
​	相当于在 $|I| = k$ 个质因子中选 $j\,(0 \le j \le k)$ 个。当选出奇数个时，对答案有 $-1$ 的贡献；当选出偶数个时，对答案有 $1$ 的贡献。

​	由于在 $k > 0$ 时，选奇数个和选偶数个的方案数是一样的，所以当 $n > 1$ 时，答案为 0。

​	以上结论用二项式定理来证明：
$$
(1 - 1)^k = C(k, 0) (-1)^0 + C(k, 1)(-1)^1 + \, ... + C(k, k) (-1)^k
$$
​	不难发现，上式的意义就是我们要求的答案。所以答案为 0。

##### 2. 反演（inversion）

###### ①定义

​	对于一个数列 $\{ f_n \}$ 来说，如果我们知道另外一个数列 $\{ g_n \}$，满足如下条件：
$$
g_n = \sum_{i = 0}^n A_{ni}f_i
$$
​	其中 $A_{ni}$ 代表一个矩阵 $A$ 的第 $n$ 行第 $i$ 列。

​	反演过程就是利用 $g_0$，$g_1$，…，$g_n$ 来表示出 $f_n$：
$$
f_n = \sum _{i = 0}^{n} B_{ni} g_i
$$
​	其中 $B_ni$ 代表一个矩阵 $B$ 的第 $n$ 行第 $i$ 列。

###### ②本质

​	==由定义，发现反演其实是一个解线性方程组的过程。==同时发现，==这个矩阵是一个三角矩阵。==

