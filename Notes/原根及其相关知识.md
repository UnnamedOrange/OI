[TOC]

# 原根及其相关知识

#### 欧拉函数与欧拉定理

##### 1. 欧拉函数

​	对于正整数 $n$，定义 $\phi (n)$ 表示比 $n$ 小且与 $n$ 互质的数的个数。

##### 2. 欧拉定理

$$
\forall gcd(a, n) = 1, a^{\phi(n)} \equiv 1 \; (mod \; n)
$$

##### 3. 扩展欧拉定理

$$
a^b \equiv a^{b \; mod \; \phi(p)} \;\;\;\;\;\;\;\; (gcd(a, p) = 1) \; (mod \; p)
\\
a^b \equiv a^b \;\;\;\;\;\;\;\ (gcd(a, p) \ne 1, b < \phi(p)) \; (mod \; p)
\\
a^b \equiv a^{(b \; mod \; \phi(p)) \; + \; \phi(p)} \;\;\;\;\;\;\;\ (gcd(a, p) \ne 1, b \ge \phi(p)) \; (mod \; p)
$$

#### 二次同余式

##### 1. 定义

​	二次同余式是关于未知数的二次多项式的同余方程，形如：
$$
ax^2 + bx + c \equiv 0 \; (mod \; p)
$$
​	形如 $x^2 \equiv a \mod p$ 的二次同余式则称为最简二次同余式。

##### 2. 剩余类

###### ①定义	

​	所有与整数 $a$ 模 $p$ 同余的整数构成的集合叫做模 $p$ 的一个剩余类，记作 $[a]$。

###### ②二次剩余与二次非剩余

​	假设 $p$ 是素数，$a$ 是整数，==如果存在一个整数 $x$ 使得 $x^2 \equiv a \; (mod \; p)$，那么称 $a$ 在 $p$ 的剩余类中是二次剩余的。==

​	假设 $p$ 是素数，$a$ 是整数，==如果**不**存在一个整数 $x$ 使得 $x^2 \equiv a \; (mod \; p)$，那么称 $a$ 在 $p$ 的剩余类中是二次**非**剩余的。==

###### ③条件

​	$a$ 是模 $p$ 的二次剩余的充要条件是 $a^{\frac {p - 1} {2}} \equiv 1 \; (mod \; p)$。

​	$a$ 是模 $p$ 的二次剩余的充要条件是 $a^{\frac {p - 1} {2}} \equiv -1 \; (mod \; p)$。

###### ④二次互反律

​	设 $a$，$p$ 是两个非零整数，我们**定义** $(\dfrac {a} {p})$ 为：若 $a$ 是模 $p$ 的二次剩余，则记 

$(\dfrac {a} {p}) = 1$，否则记 $(\dfrac {a} {p}) = -1$。

​	二次互反律：设 $p$ 和 $q$ 为不同的奇素数，有：
$$
(\dfrac {q} {p})(\dfrac {p} {q}) = (-1) ^ {\frac {p - 1}{2} \frac {q - 1}{2}}
$$

#### 指数

##### 1. 定义

​	对于两个互质的整数 $a$，$p$，定义 ==$a$ 对模 $p$ 的阶==为最小的满足 $a^d \equiv 1 \; (mod \; p)$ 的正整数 $d$，记作 $\delta_p(a)$。

​	显然 $\delta_p(a) | \phi(p)$。

##### 2. 定理和推论

$$
\delta_p(a^k) = \frac {\delta_p(a)} {gcd(\delta_p(a), k)}
$$

##### 3. 求阶

​	暴力枚举 $\phi(p)$ 的约数就可以了。

#### 原根

##### 1. 定义

​	==满足 $\delta_p(a) = \phi(p)$ 的 $a$ 称为 $a$ 称为 $p$ 的原根。==

##### 2. 存在的条件

​	模 m 有原根的充要条件是 m 为 2，4，p，2p，$p^n$，其中 $p$ 是奇素数，$n$ 是任意正整数。

##### 3. 性质

​	（1）如果模 $p$ 有原根，那么它有 $\phi(\phi(p))$ 个原根。

​	（2）设 $p$ 是奇质数，$g$ 是 $p$ 的原根，则 $g$ **或者** $g + p$ 是 $p^2$ 的一个原根。

​	（3）设 $p$ 是奇质数，$k$ 是任意自然数，$g$ 是 $p^k$ 的一个原根，则 $g$ 与 $g + p^k$ 中的奇数是 $2p^k$ 的一个原根。

##### 4. 求原根

​	对 $\phi(n)$ 质因子分解，得 $\phi(n) = p_1^{a_1} p_2^{a_2} ... p_k^{a_k}$。若恒有  $g^{\frac {\phi(n)} {p_i}} \ne 1 \; (mod \; p)$（检测 $k$ 次），则 $g$ 就是 $n$ 的原根。$g$ 要从 2 枚举到 $n - 1$。

#### 大步小步算法

##### 1. 问题

​	求解关于 $x$ 的方程 $a^x \equiv b \; (mod \; p)$，其中 $a$，$b$ 与 $p$ 互质。

##### 2. 暴力方法

​	$O(\phi(n))$ 枚举。

##### 3. 大步小步算法（BSGS）

​	==设一个参数 $l$==，将 $a^0$，$a^1$，$a^2$，...，$a^{l - 1}$ 存进哈希表，然后==枚举== $k \le \frac {\phi(p) - 1} {l}$。

​	每次查询哈希表中是否有 $j$ 满足 $a^{kl + j} \equiv b \; (mod \; p)$，即查询 $a^j = ba^{-kl} \; mod \; p$ 是否在哈希表中存在。

​	预处理的时间复杂度为 $O(\sqrt n)$，单次查询的时间复杂度为 $O(\sqrt n)$。

##### 4. 扩展大步小步算法（BSGSEx）

###### ①问题

​	求解关于 $x$ 的方程 $a^x \equiv b \; (mod \; p)$，其中 $a$，$b$ **不**与 $p$ 互质。

###### ②解法

​	原理是：把 $a$ 和 $p$ 变成互质的，每次取 $d = \gcd(a, p)$。

​	==若 $d \nmid b$，则无解。==否则得到这个方程 $\frac {a} {d} × a^{x - 1} \equiv \frac {b} {d} \; (mod \; \frac {p} {d})$。

​	