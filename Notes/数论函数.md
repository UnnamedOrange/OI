[TOC]

# 数论函数

#### 数论函数

#####1. 定义

​	把==定义域为正整数==，陪域[^ 1 ]为复数的函数称为数论函数。~~所以说我们研究的范围可广了……~~

[^ 1 ]: 包含值域的任意集合，称为陪域。

##### 2. 记号

######艾弗森约定

​	将真或假的命题 $P(k)$ 放在方括号中。当命题 $P(k)$ 为真时，命题的结果为 1；为假时，结果为 0。这种表示方法叫作==艾弗森约定==。
$$
[命题 \, k] = 
\left\{\begin{matrix}
0, \, k \, 为假
\\
1, \, k \, 为真
\end{matrix}\right.
$$

####积性函数

##### 1. 定义

​	积性函数：对于**任意互质的整数** $a$ 和 $b$ 有 $f(ab) = f(a) f(b)$ 的数论函数，称为积性函数。

​	完全积性函数：对于**任意整数** $a$ 和 $b$ 有 $f(ab) = f(a) f(b)$ 的数论函数，称为完全积性函数。

##### 2. 常见积性函数

###### ①单位函数

$$
\epsilon(n)
\\
\epsilon(n) = [n = 1]
$$

###### ②常函数

$$
1(n)
\\
1(n) = 1
$$

​	常函数是完全积性函数。

​	常函数也写作 $1$。

###### ③恒等函数

$$
id(n)
\\
id(n) = n
$$

​	恒等函数是完全积性函数。

###### ④欧拉函数

$$
\phi(n)
\\
\phi(n) = \sum _{i = 1} ^{n} [\gcd(i, n) = 1]
$$

###### ⑤除数函数

$$
\sigma_k(n)
\\
\sigma_k(n) = \sum _{d \mid n} d^k
$$

​	==$\sigma_0(n)$ 表示 $n$ 的正因子数目。==

​	==$\sigma_1(n)$ 表示 $n$ 的正因子之和。==

###### ⑥莫比乌斯（Möbius）函数

$$
\mu(n)
\\
\mu(n) = 
\left\{\begin{matrix}
0 \;\;\;\;\;\;\;\; \exists d > 1, \, d^2 \mid n
\\
1 \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\, n = 1
\\
(-1)^k \;\;\;\;\;\;\;\; n = \prod _{i = 1} ^ {k} p_i
\end{matrix}\right.
$$

​	==当 $n = 1$ 时，$\mu(n) = 1$；当 $n$ 存在一个质因子的指数大于等于 2 时，$\mu(n) = 0$；否则，当 $n$ 有奇数个质因子时，$\mu(n) = -1$；当 $n$ 有偶数个质因子时，$\mu(n) = 1$。==

​	$n = 1$ 的情况可以归类到 $n$ 有偶数个因子的情况。

##### 3. 欧拉函数

###### ①性质

$$
\phi(ab) = \phi(a) \phi(b) \frac {\gcd(a, b)} {\phi(\gcd(a, b))} = \phi(lcm(a, b)) \phi(\gcd(a, b))
$$

###### ②欧拉函数线性筛

​	用最小的因子去筛。

​	当 $i$ 为质数时，$\phi(i)$ 为 $i - 1$；当 $i$ 与 $k$ 互质时，$\phi(ki) = \phi(i) × \phi(k) = \phi(i) × (k - 1)$；当 $i$ 与 $k$ 不互质且 $k$ 是 $i$ 的最小质因子时，$\phi(ki) = \phi(k) \phi(i) \frac {gcd(k, i)} {\phi(gcd(k, i))} = \phi(k) \phi(i) \frac {k} {\phi(k)} = \phi(i) × k$。

##### 4. 狄利克雷卷积

###### ①定义

​	

#### 莫比乌斯反演

#####1. 莫比乌斯函数

###### 莫比乌斯等式

$$
(\sum _{d \mid n} \mu(d)) = \epsilon(n)
$$

​	$\epsilon$ 为单位函数。

###### 证明

​	当 $n = 1$ 时，答案显然成立。

​	当 $n > 1$ 时，$n = \prod_i^k p_i^{a_i}$。

​	则有
$$
\forall_{d \mid n, \mu(d) \ne 0} d = \prod_{i \in I} p_i, \, I \subseteq \{ 1, 2, ... , k \}
$$
​	相当于在 $|I| = k$ 个质因子中选 $j\,(0 \le j \le k)$ 个。当选出奇数个时，对答案有 $-1$ 的贡献；当选出偶数个时，对答案有 $1$ 的贡献。

​	由于在 $k > 0$ 时，选奇数个和选偶数个的方案数是一样的，所以当 $n > 1$ 时，答案为 0。

​	以上结论用二项式定理来证明：
$$
(1 - 1)^k = C(k, 0) (-1)^0 + C(k, 1)(-1)^1 + \, ... + C(k, k) (-1)^k
$$
​	不难发现，上式的意义就是我们要求的答案。所以答案为 0。

##### 2. 反演（inversion）

###### ①定义

​	对于一个数列 $\{ f_n \}$ 来说，如果我们知道另外一个数列 $\{ g_n \}$，满足如下条件：
$$
g_n = \sum_{i = 0}^n A_{ni}f_i
$$
​	其中 $A_{ni}$ 代表一个矩阵 $A$ 的第 $n$ 行第 $i$ 列。

​	反演过程就是利用 $g_0$，$g_1$，…，$g_n$ 来表示出 $f_n$：
$$
f_n = \sum _{i = 0}^{n} B_{ni} g_i
$$
​	其中 $B_ni$ 代表一个矩阵 $B$ 的第 $n$ 行第 $i$ 列。

##### ②本质

​	==由定义，发现反演其实是一个解线性方程组的过程。==同时发现，==这个矩阵是一个三角矩阵。==

