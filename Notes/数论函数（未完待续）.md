[TOC]

# 数论函数

#### 数论函数

#####1. 定义

​	把==定义域为正整数==，陪域[^1]为复数的函数称为数论函数。~~所以说我们研究的范围可广了……~~

[^1]: 包含值域的任意集合，称为陪域。

##### 2. 记号

######艾弗森约定

​	将真或假的命题 $P(k)$ 放在方括号中。当命题 $P(k)$ 为真时，命题的结果为 1；为假时，结果为 0。这种表示方法叫作==艾弗森约定==。
$$
[命题 \, k] = 
\left\{\begin{matrix}
0, \, k \, 为假
\\
1, \, k \, 为真
\end{matrix}\right.
$$

####积性函数

##### 1. 定义

​	积性函数：对于**任意互质的整数** $a$ 和 $b$ 有 $f(ab) = f(a) f(b)$ 的数论函数，称为积性函数。

​	完全积性函数：对于**任意整数** $a$ 和 $b$ 有 $f(ab) = f(a) f(b)$ 的数论函数，称为完全积性函数。

##### 2. 常见积性函数

###### ①Dirichlet 卷积单位元

$$
\epsilon(n)
\\
\epsilon(n) = [n = 1]
$$

​	Dirichlet 卷积单位元将在 Dirichlet 卷积中介绍。

###### ②常函数

$$
1(n)
\\
1(n) = 1
$$

​	常函数是完全积性函数。

​	常函数也写作 $1$。

###### ③恒等函数

$$
id(n)
\\
id(n) = n
$$

​	恒等函数是完全积性函数。

###### ④欧拉函数

$$
\varphi(n)
\\
\varphi(n) = \sum _{i = 1} ^{n} [\gcd(i, n) = 1]
$$

###### ⑤除数函数

$$
\sigma_k(n)
\\
\sigma_k(n) = \sum _{d \mid n} d^k
$$

​	==$\sigma_0(n)$ 表示 $n$ 的正因子数目，也记为 $d(n)$。==

​	==$\sigma_1(n)$ 表示 $n$ 的正因子之和，也记为 $\sigma(n)$。==

###### ⑥莫比乌斯（Möbius）函数

$$
\mu(n)
\\
\mu(n) = 
\left\{\begin{matrix}
0 \;\;\;\;\;\;\;\; \exists d > 1, \, d^2 \mid n
\\
1 \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\, n = 1
\\
(-1)^k \;\;\;\;\;\;\;\; n = \prod _{i = 1} ^ {k} p_i
\end{matrix}\right.
$$

​	==当 $n = 1$ 时，$\mu(n) = 1$；当 $n$ 存在一个质因子的指数大于等于 2 时，$\mu(n) = 0$；否则，当 $n$ 有奇数个质因子时，$\mu(n) = -1$；当 $n$ 有偶数个质因子时，$\mu(n) = 1$。==

​	$n = 1$ 的情况可以归类到 $n$ 有偶数个因子的情况。[^2]

[^2]: 莫比乌斯函数的更多内容将在下文提及。

##### 3. 积性的定理

######①积性函数的充要条件

​	设 $f(n)$ 是不恒为零的数论函数，$n = p_1^{a_1} p_2^{a_2} ... p_r^{a_r}$。

​	$f(n)$ 是积性函数的充要条件是 $f(1) = 1$ 且 $f(n) = f(p_1^{a_1}) f(p_2^{a_2}) ... f(p_r^{a_r})$。

​	$f(n)$ 是完全积性函数的充要条件是 $f(1) = 1$ 且 $f(n) = f^{a_1}(p_1) f^{a_2}(p_2) ... f^{a_r}(p_r)$。

###### ②正除数求和

​	定义
$$
F(n) = \sum _{d \mid n} f(d)
$$

>   Lemma
>
>   定义
>   $$
>   f(n) = \sum _{i_1 = 1}^{a_1} \sum _{i_2 = 1}^{a_2} ... \sum _{i_r = 1}^{a_r} f_1(s_{1, i_1}) f_2(s_{2, i_2}) ... f_r(s_{r, i_r})
>   $$
>   可以得到
>   $$
>   f(n) = \prod _{j = 1} ^ {r} (\sum _{i = 1} ^{a_j} f_j(s_{j, i}))
>   $$
>

​	可以将 $F(n)$ 表示为
$$
F(n) = \sum_{e_1 = 0}^{a_1} \sum_{e_2 = 0}^{a_2} ... \sum_{e_r = 0}^{a_r} f(p_1^{e_1}) f(p_2^{e_2}) ... f(p_r^{e_r})
$$
​	由引理，可知
$$
F(n) = F(p_1^{e_1}) F(p_2^{e_2}) ... F(p_r^{e_r})
$$
​	由此得出结论：==若 $f(n)$ 为积性函数，则 $\sum_{d \mid n} f(d)$ 也为积性函数。==[^3]

[^3]: 这个函数将在后文详细讲解。 

##### 4. 欧拉函数

###### ①性质

$$
\varphi(p^a) = p^a - p^{a - 1}
\\
\varphi(ab) = \varphi(a) \phi(b) \frac {\gcd(a, b)} {\varphi(\gcd(a, b))} = \varphi(lcm(a, b)) \varphi(\gcd(a, b))
$$

###### ②欧拉函数线性筛

​	用最小的因子去筛。

​	当 $i$ 为质数时，$\varphi(i)$ 为 $i - 1$；当 $i$ 与 $k$ 互质时，$\varphi(ki) = \varphi(i) × \varphi(k) = \varphi(i) × (k - 1)$；当 $i$ 与 $k$ 不互质且 $k$ 是 $i$ 的最小质因子时，$\varphi(ki) = \varphi(k) \varphi(i) \frac {gcd(k, i)} {\varphi(gcd(k, i))} = \varphi(k) \varphi(i) \frac {k} {\varphi(k)} = \varphi(i) × k$。

##### 5. 狄利克雷（Dirichlet）卷积

###### ①定义

​	设数论函数 $f$，$g$，则它们的狄利克雷卷积可以表示为 $f * g$。

​	设 $h = f * g$，有：
$$
h(n) = (f * g)(n) = \sum _{d \mid n} f(n) g(\frac {n} {d})
$$
​	称 $h$ 为 $f$ 和 $g$ 的狄利克雷卷积。[^4]

[^4]: 狄利克雷卷积的更多内容将在后文继续讲解。 

###### ②运算律

​	（1）交换律：$f * g = g * f$

​	（2）结合律：$(f * g) * h = f * (g * h)$

​	（3）单位元

​		==若有数论函数 $h$ 对于所有的数论函数 $f$，均有 $f * h = h * f = f$，称 $h$ 为单位数论函数，或称之为卷积单位元。==

​		==**通过验证不难得到，狄利克雷卷积的单位元为 $\epsilon$。**==

###### ③积性

​	==**若 $f$ 和 $g$ 均为积性函数，则 $f * g$ 为积性函数；反之，若 $g$ 和 $f * g$ 均为积性函数，则 $f$ 为积性函数。**==

###### ④举例

$$
d(n) = \sum _{d \mid n} 1
\\
d = 1 * 1
$$



$$
\sigma(n) = \sum _{d \mid n} d
\\
\sigma = id * 1
$$



$$
\sum _{d \mid n} \mu(d) = \epsilon(n)
\\
\mu * 1 = \epsilon
$$
​	上式为==莫比乌斯等式==，将在下文讲解。



$$
\sum _{d \mid n} \varphi(d) = n
\\
\varphi * 1 = id
$$

>   证明
>
>   ​	当 $m = p^a$ 时，有
>   $$
>   \sum _{d \mid p^a} \varphi(d) = \varphi(1) + \varphi(p) + \varphi(p^2) + ... + \varphi(p^a) = p^a
>   $$
>   ​	由该函数的积性，可推出原式，得证！



$$
\varphi(n) = \sum_{d \mid n} \mu(d) \frac {n} {d}
\\
\varphi = \mu * id
$$

>证明
>
>​	==这里利用卷积的性质来证明。==
>
>​	等式两边同乘以 $1$ 得 $\varphi(n) * 1 = \mu * 1 * id$。
>
>​	由莫比乌斯等式和 $\varphi * 1 = id$，可以得到
>$$
>id = \epsilon * id
>$$
>​	得到一恒等式（$\epsilon$ 是单位元），得证！

#### 莫比乌斯反演

#####1. 莫比乌斯等式

$$
\sum _{d \mid n} \mu(d) = \epsilon(n)
\\
\mu * 1 = \epsilon
$$

​	$\epsilon$ 为单位函数。

###### ①证明

​	当 $n = 1$ 时，答案显然成立。

​	当 $n > 1$ 时，$n = \prod_i^k p_i^{a_i}$。

​	则有
$$
\forall_{d \mid n, \mu(d) \ne 0} d = \prod_{i \in I} p_i, \, I \subseteq \{ 1, 2, ... , k \}
$$
​	相当于在 $|I| = k$ 个质因子中选 $j\,(0 \le j \le k)$ 个。当选出奇数个时，对答案有 $-1$ 的贡献；当选出偶数个时，对答案有 $1$ 的贡献。

​	由于在 $k > 0$ 时，选奇数个和选偶数个的方案数是一样的，所以当 $n > 1$ 时，答案为 0。

​	以上结论用二项式定理来证明：
$$
(1 - 1)^k = C(k, 0) (-1)^0 + C(k, 1)(-1)^1 + \, ... + C(k, k) (-1)^k
$$
​	不难发现，上式的意义就是我们要求的答案。所以答案为 0。

##### 2. 反演（inversion）

###### ①定义

​	对于一个数列 $\{ f_n \}$ 来说，如果我们知道另外一个数列 $\{ g_n \}$，满足如下条件：
$$
g_n = \sum_{i = 0}^n A_{ni}f_i
$$
​	其中 $A_{ni}$ 代表一个矩阵 $A$ 的第 $n$ 行第 $i$ 列。

​	反演过程就是利用 $g_0$，$g_1$，…，$g_n$ 来表示出 $f_n$：
$$
f_n = \sum _{i = 0}^{n} B_{ni} g_i
$$
​	其中 $B_ni$ 代表一个矩阵 $B$ 的第 $n$ 行第 $i$ 列。

###### ②本质

​	==由定义，发现反演其实是一个解线性方程组的过程。==同时发现，==这个矩阵是一个三角矩阵。==
