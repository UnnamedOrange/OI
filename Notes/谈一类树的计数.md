[TOC]

# 谈一类树的计数

&emsp;&emsp;从最简单的开始。

#### 有标号无根树

&emsp;&emsp;首先你得知道 [Prüfer 序列]() 的相关知识。

##### 1. 没有限制时

&emsp;&emsp;直接由 Cayley 定理得无限制的有标号无根树的计数为[^n]：
$$
n^{n - 2}
$$

[^n]: 如果没有特殊说明，默认有 $n$ 个结点。

#####2. 给定度数时

&emsp;&emsp;设每个点的度数为 $d_i$，直接由 Prüfer 序列的推论得计数为：
$$
\frac {n!} {\prod_{i = 1}^{n} (d_i - 1)}
$$

##### 3. 有度数限制时

&emsp;&emsp;设每个点的度数最多为 $d_i$，好像问题就变得棘手起来了。

&emsp;&emsp;考虑继续结合 Prüfer 序列的相关知识使用动态规划。设 $f_{i, j}$ 表示考虑了前 $i$ 个结点，Prüfer 序列长为 $j$ 时的计数。

&emsp;&emsp;转移时，枚举当前点的度数，结合组合数转移即可。时间复杂度 $O(n^3)$。

```c++
f[0][0] = 1;
for (int i = 1; i <= n; i++)
    for (int j = 0; j <= n - 2; j++)
        for (int k = 0; k < d[i] && j - k >= 0; k++)
            f[i][j] = (f[i][j] + f[i - 1][j - k] * C(j, k) % mod) % mod;
printOut(f[n][n - 2]);
```

##### 4. e.g. [BZOJ 明明的烦恼](http://www.lydsy.com/JudgeOnline/problem.php?id=1005)

 