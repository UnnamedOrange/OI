[TOC]

# 树的度序列和 Prüfer 编码

## 树的度序列

##### 1. 来源

&emsp;&emsp;由于树有 $n - 1$ 条边，因此树的度数和为 $2(n - 1)$。**反过来，**如果我们知道了一个**不上升的**正整数序列 $S$： $d_1, d_2, d_3, \cdots, d_n$，且它们的和为 $2(n - 1)$，我们就可以构造出以它为度序列的树。

##### 2. 证明

&emsp;&emsp;用数学归纳法。

&emsp;&emsp;假设 $n = k$ 时成立，只需证明 $n = k + 1$ 时也成立。首先必然有 $d_{k + 1} = 1$，否则序列和至少为 $2(k + 1) > 2k$（因为递增）。我们从序列中删去 $d_1$ 和 $d_{k +1}$ 并增加 $d' = d_1 - 1$ 到序列中一个保持不上升的位置。那么，现在这个序列的度数和为 $2(n - 1)$，**根据假设，**这可以构造出一棵合法的树。现在增加一个新结点 v，把它和 $d'$ 对应的结点相连，则 $d'$ 的值变为 $d_1$，并且增加了一个度为 1 的结点 v，因此新树的结点序列为 S。得证！

&emsp;&emsp;然后就可以说明，在 S 乱序时也成立了。

## Prüfer 编码

##### 1. 编码方法

&emsp;&emsp;设树为 T。

&emsp;&emsp;① 找到 T 编号最小的叶子结点 $b_1$，设它的相邻接点为 $a_1$。**这里的叶子结点是指度为 $1$ 的结点。**

&emsp;&emsp;② 从 T 中删除 $b_1$，将 $a_1$ 添加到编码的尾部。

&emsp;&emsp;③ 重复以上过程，直到只剩下两个结点。

&emsp;&emsp;我们就得到了一个**长度为 $n - 2$** 的有序序列 $a$。

##### 2. 解码方法

&emsp;&emsp;①首先令 $a_{n - 1} = n$，即把编码手动延长至 n - 1 个数。

&emsp;&emsp;②令 $b_i$ 为不在当前序列的编号最小的点，则当前序列的第一个结点与 $b_i$ 有边。把它们连起来，然后**删去当前序列的第一个结点，并且不再记录 $b_i$。**

&emsp;&emsp;可以用堆进行这个操作，注意删去序列中的结点后可能会产生新的序列中没有出现过的点，这时要把它加入堆中。时间复杂度为 $O(n \log n)$。

##### 3. Cayley 定理

&emsp;&emsp;**Prüfer 编码中的每一位可以独立取 $1 \sim n$ 的任意数，即一个 Prüfer 序列对应一棵带标号无根树，因此有得到 Cayley 定理：**

&emsp;&emsp;不同的 $n$ 结点标号树的数量是 $n^{n - 2}$。

##### 4. 一些推论

&emsp;&emsp;①若在 Prüfer 序列中一个点出现了 $x$ 次，那么这个点的度数为 $x + 1$。

&emsp;&emsp;②若一棵树的度数为分别为 $a_1, a_2, a_3, \cdots, a_n$，那么这棵树的同构数目为 $\frac {n!} {(a_1 - 1)!(a_2 - 1)! \, ... \, (a_n - 1)!}$。